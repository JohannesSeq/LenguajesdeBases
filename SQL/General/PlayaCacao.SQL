------------------- Correr en System ---------------------------------------
--Creacion del Schema para la base de datos
alter session set "_ORACLE_SCRIPT"=true;
CREATE TABLESPACE PLAYA_CACAO_TBS
DATAFILE 'C:\ORACLE\oradata\XE\PLAYA_CACAO_TBS.dbf' SIZE 100M;


--Creacion del usuario para la base de datos
CREATE USER PlayaCacaoDB IDENTIFIED BY PlayaCacao12345;

GRANT EXECUTE ON DBMS_CRYPTO TO PlayaCacaoDB;
GRANT UNLIMITED TABLESPACE to PlayaCacaoDB;
 
CREATE USER PlayaCacaoLecturas IDENTIFIED BY PlayaCacao12345;

--Creacion de Roles para el usuario en la DB
CREATE ROLE ACCESO_PLAYA_CACAO_DB NOT IDENTIFIED;

--Creacion de permisos de aceso
GRANT CREATE SESSION TO ACCESO_PLAYA_CACAO_DB;
GRANT RESOURCE TO ACCESO_PLAYA_CACAO_DB;
GRANT CONNECT TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.CANTON TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.CORREOS TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.DEPARTAMENTOS TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.DIRECCIONES_PERSONAS TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.DISTRITO TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.EMPLEADOS TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.ENCRIPCION_PASSWORDS TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.ESTADOS TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.FACTURAS TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.HORARIOS_MESA TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.LISTA_PLATILLOS TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.MENU TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.MESAS TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.METODO_PAGO TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.PEDIDOS TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.PERSONAS TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.PROVINCIA TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.PUESTOS TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.RESERVACIONES TO ACCESO_PLAYA_CACAO_DB;
GRANT SELECT ON PlayaCacaoDB.ROL_PERSONA TO ACCESO_PLAYA_CACAO_DB;


--Creacion de permisos de administracion
CREATE ROLE ADMINISTRACION_PLAYACACAO_DB NOT IDENTIFIED;

GRANT CREATE TABLE TO ACCESO_PLAYA_CACAO_DB;
GRANT CREATE VIEW TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.CANTON TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.CANTON TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.CORREOS TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.CORREOS TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.DEPARTAMENTOS TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.DEPARTAMENTOS TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.DIRECCIONES_PERSONAS TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.DIRECCIONES_PERSONAS TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.DISTRITO TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.DISTRITO TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.EMPLEADOS TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.EMPLEADOS TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.ENCRIPCION_PASSWORDS TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.ENCRIPCION_PASSWORDS TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.ESTADOS TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.ESTADOS TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.FACTURAS TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.FACTURAS TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.HORARIOS_MESA TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.HORARIOS_MESA TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.LISTA_PLATILLOS TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.LISTA_PLATILLOS TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.MENU TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.MENU TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.MESAS TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.MESAS TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.METODO_PAGO TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.METODO_PAGO TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.PEDIDOS TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.PEDIDOS TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.PERSONAS TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.PERSONAS TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.PUESTOS TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.PUESTOS TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.RESERVACIONES TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.RESERVACIONES TO ACCESO_PLAYA_CACAO_DB;

GRANT UPDATE ON PlayaCacaoDB.ROL_PERSONA TO ACCESO_PLAYA_CACAO_DB;
GRANT DELETE ON PlayaCacaoDB.ROL_PERSONA TO ACCESO_PLAYA_CACAO_DB;



-- Asignacion del rol al usuario de playa cacao
GRANT ACCESO_PLAYA_CACAO_DB TO PlayaCacaoDB;
GRANT ADMINISTRACION_PLAYACACAO_DB TO PlayaCacaoDB;

-- Asignacion del rol de lectura al usuario de lecturas
GRANT ACCESO_PLAYA_CACAO_DB TO PlayaCacaoLecturas;

-- Crecion de los perfiles de la base de datos de playa Cacao
CREATE PROFILE PLAYACACAODB_PROFILE LIMIT
    SESSIONS_PER_USER 3
    IDLE_TIME 30
    FAILED_LOGIN_ATTEMPTS 5;

ALTER USER PlayaCacaoDB PROFILE PLAYACACAODB_PROFILE;


CREATE PROFILE PLAYACACAODB_LECTURAS_PROFILE LIMIT
    SESSIONS_PER_USER 5
    IDLE_TIME 60
    FAILED_LOGIN_ATTEMPTS 5;

ALTER USER PlayaCacaoLecturas PROFILE PLAYACACAODB_PROFILE;
